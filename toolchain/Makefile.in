TOOLCHAIN := $(realpath $(dir $(lastword $(MAKEFILE_LIST))))

# WITH section
WITH_PYTHON = @WITH_PYTHON@

# Paths
PYTHON_DIR = $(TOOLCHAIN)/python

.PHONY: init python

init: python

$(PYTHON_DIR)/Makefile:
ifeq ($(WITH_PYTHON),yes)
	cd $(PYTHON_DIR) && ./configure
endif

python: $(PYTHON_DIR)/Makefile
	cd $(PYTHON_DIR) && $(MAKE) -f $(PYTHON_DIR)/Makefile all

distclean:
	rm -Rf {$(TOOLCHAIN),$(TOOLCHAIN)/*}/config.log
	rm -Rf {$(TOOLCHAIN),$(TOOLCHAIN)/*}/aclocal.m4
	rm -Rf {$(TOOLCHAIN),$(TOOLCHAIN)/*}/config.status
	rm -Rf {$(TOOLCHAIN),$(TOOLCHAIN)/*}/configure~
	rm -Rf {$(TOOLCHAIN),$(TOOLCHAIN)/*}/autom4te.cache
	rm -Rf {$(TOOLCHAIN),$(TOOLCHAIN)/*}/Makefile
